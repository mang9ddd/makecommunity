const fs = require('fs');
const path = require('path');

// 환경 변수에서 Supabase 설정 읽기
const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || '';
const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || '';

// supabase-config.js 파일 내용 생성
const configContent = `// This file is auto-generated during build
// Do not edit this file manually

window.__SUPABASE_CONFIG__ = {
  url: '${supabaseUrl}',
  anonKey: '${supabaseAnonKey}'
};

export const supabaseUrl = '${supabaseUrl}';
export const supabaseAnonKey = '${supabaseAnonKey}';
`;

// public 폴더 경로
const publicDir = path.join(process.cwd(), 'public');
const configPath = path.join(publicDir, 'supabase-config.js');

// public 폴더가 없으면 생성
if (!fs.existsSync(publicDir)) {
  fs.mkdirSync(publicDir, { recursive: true });
}

// 파일 작성
fs.writeFileSync(configPath, configContent, 'utf8');

console.log('✅ supabase-config.js generated successfully');
console.log(`   Location: ${configPath}`);
console.log(`   Supabase URL: ${supabaseUrl ? 'Set' : 'Missing'}`);
console.log(`   Supabase Anon Key: ${supabaseAnonKey ? 'Set' : 'Missing'}`);

if (!supabaseUrl || !supabaseAnonKey) {
  console.warn('⚠️  Warning: Supabase environment variables are missing!');
  console.warn('   The generated config file will have empty values.');
}


